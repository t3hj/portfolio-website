<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game - Tehj Patel</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/projects.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #f5f5f5;
            background-color: #0a1a33;
        }
        .navbar {
            background-color: #0d3b66;
            color: #f5f5f5;
            padding: 10px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;          
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        .navbar h1 {
            margin: 0;
            padding: 0 20px;
        }
        .navbar .nav-links a {
            color: #f5f5f5;
            text-decoration: none;
            padding: 10px 20px;
            display: inline-block;
        }
        .navbar .nav-links a.active {
            background-color: rgba(255, 221, 87, 0.1);
            color: #ffdd57;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            margin-top: 98px; /* Adjust based on navbar height */
            padding: 20px;
            background-color: #0d3b66; /* Dark background */
            color: #f5f5f5; /* Light text */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .project-detail h2 {
            color: #ffdd57; /* Yellow text */
            border-bottom: 2px solid #ffdd57; /* Yellow border */
            padding-bottom: 10px;
        }
        .project-detail img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .project-detail h3 {
            color: #ffdd57; /* Yellow text */
            margin-top: 30px;
        }
        .project-detail ul, .project-detail ol {
            margin: 20px 0;
            padding-left: 20px;
        }
        .project-detail ul li, .project-detail ol li {
            margin-bottom: 10px;
        }
        .cta-button {
            display: inline-block;
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #0d3b66; /* Dark background */
            color: #ffdd57; /* Yellow text */
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .cta-button:hover {
            background-color: #1a73e8;
            color: white;
        }
        footer {
            text-align: center;
            padding: 20px 0;
            background-color: #0d3b66;
            color: #f5f5f5;
            margin-top: 40px;
        }
        
        /* Snake Game specific styles */
        .game-container {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ffdd57;
            position: relative;
        }
        
        .game-canvas {
            display: block;
            margin: 0 auto;
            background-color: #000;
            border: 1px solid #ffdd57;
        }
        
        .game-controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .control-button {
            padding: 10px 20px;
            background-color: #1a73e8;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .control-button:hover {
            background-color: #0d47a1;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255, 221, 87, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .feature-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #ffdd57;
        }
        
        .feature-card h4 {
            color: #ffdd57;
            margin: 10px 0;
        }
        
        .feature-card p {
            margin-top: 5px;
        }
        
        .code-section {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: monospace;
            border-left: 3px solid #ffdd57;
            color: #d4d4d4;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .comment { color: #6a9955; }
        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .function { color: #dcdcaa; }
        .class { color: #4ec9b0; }
        
        .welcome-screen {
            background-color: #000;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        .welcome-title {
            color: #ffdd57;
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .welcome-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 80%;
            max-width: 300px;
        }
        
        .color-selection {
            display: flex;
            justify-content: space-around;
            margin: 10px 0 20px;
        }
        
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #333;
            transition: transform 0.2s, border-color 0.2s;
        }
        
        .color-option:hover, .color-option.selected {
            transform: scale(1.2);
            border-color: #ffdd57;
        }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            display: none;
        }
        
        .game-over-text {
            color: #ff4d4d;
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .score-text {
            color: white;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .game-stats {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 5px;
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 20px;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #ffdd57;
        }
        
        .stat-value {
            font-size: 16px;
            font-weight: bold;
        }
        
        .direction-buttons {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 20px auto 0;
            display: none;
        }
        
        .direction-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid #ffdd57;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        
        .up-btn { top: 0; left: 50px; }
        .right-btn { top: 50px; left: 100px; }
        .down-btn { top: 100px; left: 50px; }
        .left-btn { top: 50px; left: 0; }
        
        @media (max-width: 768px) {
            .direction-buttons {
                display: block;
            }
        }
    </style>
</head>
<body data-theme="custom">
    <script>
        document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'custom');
    </script>
    <nav class="navbar">
        <div class="nav-content">
            <button class="hamburger-menu" aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
            <div class="nav-links">
                <a href="../index.html">Home</a>
                <a href="../about.html">About</a>
                <a href="../projects.html" class="active">Projects</a>
                <a href="../skills.html">Skills</a>
                <a href="../contact.html">Contact</a>
            </div>
            <div class="theme-toggle custom">
                <div class="toggle-thumb"></div>
            </div>
        </div>
    </nav>
    <section class="project-detail">
        <div class="container">
            <h2>Snake Game</h2>
            <img src="../images/SnakeGame/snakeGame.png" alt="Snake Game Screenshot">
            <p>This Snake Game is a classic arcade-style game implemented in Java using the Swing library. Players control a snake that moves around the screen, eating food to grow longer while avoiding collisions with walls and itself. The game features multiple states including a customizable welcome screen, active gameplay, and a game over screen with high score tracking.</p>
            <h3>Project Overview</h3>
            <p>This Snake Game is a classic arcade-style game implemented in Java using the Swing library. Players control a snake that moves around the screen, eating food to grow longer while avoiding collisions with walls and itself. The game features multiple states including a customizable welcome screen, active gameplay, and a game over screen with high score tracking.</p>
            <h3>Interactive Demo</h3>
            <p>Try out the Snake Game below. Use the arrow keys to control the snake's direction, eat the red food, and avoid hitting the walls or yourself!</p>
            <div class="game-container" id="game-demo-container">
                <canvas id="game-canvas" class="game-canvas" width="500" height="400"></canvas>
                <div class="welcome-screen" id="welcome-screen">
                    <div class="welcome-title">Welcome to Snake Game</div>
                    <div class="welcome-options">
                        <p>Select snake color:</p>
                        <div class="color-selection">
                            <div class="color-option selected" style="background-color: #00ff00;" data-color="#00ff00"></div>
                            <div class="color-option" style="background-color: #0000ff;" data-color="#0000ff"></div>
                            <div class="color-option" style="background-color: #ff0000;" data-color="#ff0000"></div>
                            <div class="color-option" style="background-color: #ffff00;" data-color="#ffff00"></div>
                            <div class="color-option" style="background-color: #ff00ff;" data-color="#ff00ff"></div>
                        </div>
                        <button class="control-button" id="start-button">Start Game</button>
                    </div>
                </div>
                <div class="game-over" id="game-over-screen">
                    <div class="game-over-text">Game Over!</div>
                    <div class="score-text">Score: <span id="final-score">0</span></div>
                    <div class="score-text">High Score: <span id="high-score">0</span></div>
                    <button class="control-button" id="play-again-button">Play Again</button>
                </div>
                <div class="game-stats" id="game-stats">
                    <div class="stat">
                        <span class="stat-label">Score</span>
                        <span class="stat-value" id="score-display">0</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">High Score</span>
                        <span class="stat-value" id="high-score-display">0</span>
                    </div>
                </div>
                <div class="game-controls">
                    <button class="control-button" id="pause-button">Pause (P)</button>
                </div>
                <div class="direction-buttons">
                    <div class="direction-btn up-btn" id="up-btn"><i class="fas fa-arrow-up"></i></div>
                    <div class="direction-btn right-btn" id="right-btn"><i class="fas fa-arrow-right"></i></div>
                    <div class="direction-btn down-btn" id="down-btn"><i class="fas fa-arrow-down"></i></div>
                    <div class="direction-btn left-btn" id="left-btn"><i class="fas fa-arrow-left"></i></div>
                </div>
            </div>
            <h3>Features</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <i class="fas fa-palette"></i>
                    <h4>Customizable Snake</h4>
                    <p>Choose your snake's color before starting the game for a personalized gaming experience.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-pause"></i>
                    <h4>Pause Functionality</h4>
                    <p>Pause the game at any time using the 'P' key or pause button for convenient gameplay.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-trophy"></i>
                    <h4>High Score Tracking</h4>
                    <p>The game saves your highest score, challenging you to beat your own record.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-volume-up"></i>
                    <h4>Sound Effects</h4>
                    <p>Engaging audio feedback when eating food or when the game ends for an immersive experience.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-gamepad"></i>
                    <h4>Intuitive Controls</h4>
                    <p>Easy to use arrow key controls with responsive movement for smooth gameplay.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-desktop"></i>
                    <h4>Multiple Game States</h4>
                    <p>Features welcome screen, active gameplay, and game over states for a complete arcade experience.</p>
                </div>
            </div>
            <h3>Welcome Screen</h3>
            <p>The game starts with a colorful welcome screen where you can select the snake's color and initiate the game. It provides a friendly, interactive start to the game.</p>
            <img src="../images/SnakeGame/StartScreen.png" alt="Welcome Screen" style="width: 50%;" class="float-left">
            <img src="../images/SnakeGame/ColourPicker.png" alt="Welcome Screen with Colour Picker" style="width: 50%;">
            <h3>Gameplay</h3>
            <p>Once the game starts, you control the snake using the arrow keys. The snake eats red food blocks to grow longer and increase your score. Be careful to avoid collisions with the edges of the screen or the snake's own body!</p>
            <img src="../images/SnakeGame/PlayingHighScore.png" alt="Gameplay Screen with High Score Display">
            <h4>Key Features</h4>
            <ul>
                <li><strong>Pause Functionality:</strong> Use the 'P' key to pause and resume the game at any time.</li>
                <li><strong>Score Tracking:</strong> Your current score is displayed during the game, motivating you to beat your own high scores.</li>
                <li><strong>Snake Color Selection:</strong> Choose your snake's color before starting, adding a layer of personalization.</li>
                <li><strong>Restart Button:</strong> If the game ends, you can restart easily.</li>
                <li><strong>Dynamic Game Over Screen:</strong> When the game ends, a "Game Over" screen appears with options to restart or quit.</li>
            </ul>
            <h3>Game Over Screen</h3>
            <p>When the game ends, you're presented with a Game Over screen displaying your score and offering a restart button.</p>
            <img src="../images/SnakeGame/GameOver.png" alt="Game Over Screen">
            <h3>Technical Details</h3>
            <h4>GamePanel.java</h4>
            <p>This file contains the core logic of the game:</p>
            <ul>
                <li><strong>Game State Management:</strong> Handles transitions between Welcome, Playing, and Game Over states.</li>
                <li><strong>Collision Detection:</strong> Detects collisions with walls, food, and the snake itself.</li>
                <li><strong>Snake Movement:</strong> Implements the logic for the snake's direction and position updates.</li>
                <li><strong>Food Spawning:</strong> Randomly places food on the grid, ensuring it doesn't spawn on the snake.</li>
                <li><strong>Sound Effects:</strong> Plays audio cues for key game events like eating food or game over.</li>
            </ul>
            <div class="code-section">
                <span class="keyword">private</span> <span class="keyword">void</span> <span class="function">checkCollision</span>() {
                    <span class="keyword">for</span> (<span class="keyword">int</span> i = snakeLength; i > 0; i--) {
                        <span class="comment">// Check if head collides with body</span>
                        <span class="keyword">if</span> (snakeX[0] == snakeX[i] && snakeY[0] == snakeY[i]) {
                            gameState = GameState.GAME_OVER; <span class="comment">// Update game state to GAME_OVER</span>
                            running = <span class="keyword">false</span>;
                        }
                    }
                    <span class="comment">// Check if head collides with walls</span>
                    <span class="keyword">if</span> (snakeX[0] < 0 || snakeX[0] >= WIDTH || snakeY[0] < 0 || snakeY[0] >= HEIGHT) {
                        gameState = GameState.GAME_OVER; <span class="comment">// Update game state to GAME_OVER</span>
                        running = <span class="keyword">false</span>;
                    }
                    <span class="keyword">if</span> (!running) {
                        playSound(<span class="string">"/Sounds/gameover.wav"</span>); <span class="comment">// Play sound on game over</span>
                        <span class="keyword">if</span> (snakeLength - 1 > highScore) {
                            highScore = snakeLength - 1; <span class="comment">// Update high score</span>
                        }
                        timer.stop(); <span class="comment">// Stop the timer if the game is over</span>
                    }
                }
            </div>
            <h4>Main.java</h4>
            <p>This file sets up the game window and integrates the GamePanel into a JFrame for user interaction. It handles the game's overall appearance and window properties.</p>
            <div class="code-section">
                <span class="keyword">public</span> <span class="keyword">class</span> <span class="class">Main</span> {
                    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="function">main</span>(String[] args) {
                        JFrame frame = <span class="keyword">new</span> JFrame(<span class="string">"Snake Game"</span>);
                        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                        frame.setResizable(<span class="keyword">false</span>);
                        GamePanel gamePanel = <span class="keyword">new</span> GamePanel();
                        frame.add(gamePanel);
                        frame.pack();
                        frame.setLocationRelativeTo(<span class="keyword">null</span>); <span class="comment">// Center the window</span>
                        frame.setVisible(<span class="keyword">true</span>);
                    }
                }
            </div>
            <h3>How to Play</h3>
            <ol>
                <li>Open the game and choose the snake color on the welcome screen.</li>
                <li>Click "Start Game" to begin.</li>
                <li>Use the arrow keys to guide the snake and eat food to score points.</li>
                <li>Avoid running into walls or the snake's body.</li>
                <li>If the game ends, restart from the Game Over screen or quit.</li>
            </ol>
            <h3>Development Process</h3>
            <p>This project was developed using Java and the Swing library for creating the graphical interface. The development process included:</p>
            <ul>
                <li>Designing the game mechanics and UI</li>
                <li>Implementing the snake movement and controls</li>
                <li>Adding food generation and collision detection</li>
                <li>Creating game states (welcome, playing, game over)</li>
                <li>Implementing high score tracking</li>
                <li>Adding audio feedback for enhanced user experience</li>
                <li>Testing and debugging across different scenarios</li>
            </ul>
            <a href="../projects.html" class="cta-button">Back to Projects</a>
        </div>
    </section>
    <footer>
        <p>© 2024 Tehj Patel</p>
    </footer>
    <script>
        // Set the theme before any DOM manipulation
        document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'custom');
    </script>
    <script src="../scripts/global.js"></script>
    <script>
        // Snake Game Demo Implementation
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme toggle functionality
            const themeToggle = document.querySelector('.theme-toggle');
            if (themeToggle) {
                let currentTheme = localStorage.getItem('theme') || 'custom'; // Default theme
                
                // Ensure the toggle reflects the current theme
                themeToggle.className = `theme-toggle ${currentTheme}`;
                
                themeToggle.addEventListener('click', () => {
                    // Toggle themes in sequence
                    if (currentTheme === 'dark') {
                        currentTheme = 'custom';
                    } else if (currentTheme === 'light') {
                        currentTheme = 'dark';
                    } else {
                        currentTheme = 'light';
                    }
                    
                    // Apply the theme
                    document.body.setAttribute('data-theme', currentTheme);
                    themeToggle.className = `theme-toggle ${currentTheme}`;
                    localStorage.setItem('theme', currentTheme); // Save the theme
                });
            }
            
            // Game Canvas Setup
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            
            // Game Constants
            const UNIT_SIZE = 20;
            const GAME_UNITS_X = canvas.width / UNIT_SIZE;
            const GAME_UNITS_Y = canvas.height / UNIT_SIZE;
            
            // Game Variables
            let snake = [];
            let snakeLength = 3;
            let direction = 'RIGHT';
            let foodX = 0;
            let foodY = 0;
            let score = 0;
            let highScore = 0;
            let gameSpeed = 100; // milliseconds between updates
            let running = false;
            let paused = false;
            let gameInterval;
            let snakeColor = '#00ff00'; // Default snake color
            
            // Game State
            const GameState = {
                WELCOME: 'welcome',
                PLAYING: 'playing',
                GAME_OVER: 'game_over'
            };
            
            let currentState = GameState.WELCOME;
            
            // DOM Elements
            const welcomeScreen = document.getElementById('welcome-screen');
            const gameOverScreen = document.getElementById('game-over-screen');
            const gameStats = document.getElementById('game-stats');
            const startButton = document.getElementById('start-button');
            const playAgainButton = document.getElementById('play-again-button');
            const pauseButton = document.getElementById('pause-button');
            const scoreDisplay = document.getElementById('score-display');
            const highScoreDisplay = document.getElementById('high-score-display');
            const finalScore = document.getElementById('final-score');
            const highScoreElem = document.getElementById('high-score');
            const colorOptions = document.querySelectorAll('.color-option');
            
            // Direction Buttons (for mobile)
            const upBtn = document.getElementById('up-btn');
            const rightBtn = document.getElementById('right-btn');
            const downBtn = document.getElementById('down-btn');
            const leftBtn = document.getElementById('left-btn');
            
            // Initialize Game
            function init() {
                // Set up snake initial position
                snake = [];
                for (let i = 0; i < snakeLength; i++) {
                    snake.push({x: 5 - i, y: 10});
                }
                
                // Reset game variables
                direction = 'RIGHT';
                score = 0;
                running = false;
                paused = false;
                
                // Update UI
                scoreDisplay.textContent = score;
                highScoreDisplay.textContent = highScore;
                
                // Generate first food
                spawnFood();
                
                // Show welcome screen
                welcomeScreen.style.display = 'flex';
                gameOverScreen.style.display = 'none';
                gameStats.style.display = 'none';
            }
            
            // Start Game
            function startGame() {
                running = true;
                
                // Hide welcome screen, show stats
                welcomeScreen.style.display = 'none';
                gameStats.style.display = 'flex';
                
                // Set current state
                currentState = GameState.PLAYING;
                
                // Start game loop
                clearInterval(gameInterval);
                gameInterval = setInterval(update, gameSpeed);
                
                // Draw initial state
                draw();
            }
            
            // Update Game State
            function update() {
                if (!running || paused) return;
                
                // Move snake (update positions)
                moveSnake();
                
                // Check collisions
                checkCollisions();
                
                // Check if snake ate food
                checkFood();
                
                // Draw updated state
                draw();
            }
            
            // Move Snake
            function moveSnake() {
                // Create new head position
                const head = {x: snake[0].x, y: snake[0].y};
                
                // Update head position based on direction
                switch(direction) {
                    case 'UP':
                        head.y -= 1;
                        break;
                    case 'DOWN':
                        head.y += 1;
                        break;
                    case 'LEFT':
                        head.x -= 1;
                        break;
                    case 'RIGHT':
                        head.x += 1;
                        break;
                }
                
                // Add new head to beginning of snake array
                snake.unshift(head);
                
                // Remove tail if snake didn't eat food
                if (snake.length > snakeLength) {
                    snake.pop();
                }
            }
            
            // Check Collisions
            function checkCollisions() {
                const head = snake[0];
                
                // Check wall collisions
                if (head.x < 0 || head.x >= GAME_UNITS_X || head.y < 0 || head.y >= GAME_UNITS_Y) {
                    gameOver();
                    return;
                }
                
                // Check self collisions
                for (let i = 1; i < snake.length; i++) {
                    if (head.x === snake[i].x && head.y === snake[i].y) {
                        gameOver();
                        return;
                    }
                }
            }
            
            // Check if Snake ate Food
            function checkFood() {
                const head = snake[0];
                
                if (head.x === foodX && head.y === foodY) {
                    // Increase snake length
                    snakeLength++;
                    
                    // Update score
                    score++;
                    scoreDisplay.textContent = score;
                    
                    // Spawn new food
                    spawnFood();
                    
                    // Play eat sound (simulated)
                    playEatSound();
                }
            }
            
            // Spawn Food
            function spawnFood() {
                let validPosition = false;
                
                while (!validPosition) {
                    // Generate random position
                    foodX = Math.floor(Math.random() * (GAME_UNITS_X - 1));
                    foodY = Math.floor(Math.random() * (GAME_UNITS_Y - 1));
                    
                    // Check if position is not on snake
                    validPosition = true;
                    for (let segment of snake) {
                        if (segment.x === foodX && segment.y === foodY) {
                            validPosition = false;
                            break;
                        }
                    }
                }
            }
            
            // Draw Game
            function draw() {
                // Clear canvas
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw food
                ctx.fillStyle = '#ff0000';
                ctx.fillRect(foodX * UNIT_SIZE, foodY * UNIT_SIZE, UNIT_SIZE, UNIT_SIZE);
                
                // Draw snake
                snake.forEach((segment, i) => {
                    // Head is the selected color, body is slightly lighter
                    ctx.fillStyle = i === 0 ? snakeColor : adjustColor(snakeColor, 30);
                    ctx.fillRect(segment.x * UNIT_SIZE, segment.y * UNIT_SIZE, UNIT_SIZE, UNIT_SIZE);
                    
                    // Add eye details for head
                    if (i === 0) {
                        ctx.fillStyle = '#000000';
                        switch(direction) {
                            case 'RIGHT':
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.75), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.25), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.75), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.65), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                break;
                            case 'LEFT':
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.1), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.25), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.1), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.65), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                break;
                            case 'UP':
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.25), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.1), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.65), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.1), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                break;
                            case 'DOWN':
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.25), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.75), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                ctx.fillRect((segment.x * UNIT_SIZE) + (UNIT_SIZE * 0.65), (segment.y * UNIT_SIZE) + (UNIT_SIZE * 0.75), UNIT_SIZE * 0.2, UNIT_SIZE * 0.2);
                                break;
                        }
                    }
                });
                
                // Draw pause overlay if paused
                if (paused) {
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = '30px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('PAUSED', canvas.width / 2, canvas.height / 2);
                }
            }
            
            // Game Over
            function gameOver() {
                running = false;
                clearInterval(gameInterval);
                
                // Update high score if necessary
                if (score > highScore) {
                    highScore = score;
                    highScoreDisplay.textContent = highScore;
                }
                
                // Show game over screen
                currentState = GameState.GAME_OVER;
                gameOverScreen.style.display = 'flex';
                finalScore.textContent = score;
                highScoreElem.textContent = highScore;
                
                // Play game over sound
                playGameOverSound();
            }
            
            // Helper: Adjust color brightness
            function adjustColor(color, amount) {
                // Convert hex to RGB
                let r = parseInt(color.substring(1,3), 16);
                let g = parseInt(color.substring(3,5), 16);
                let b = parseInt(color.substring(5,7), 16);
                
                // Increase brightness
                r = Math.min(255, r + amount);
                g = Math.min(255, g + amount);
                b = Math.min(255, b + amount);
                
                // Convert back to hex
                return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }
            
            // Sound effects (simulated)
            function playEatSound() {
                // In a real game, this would play an audio file
                console.log('Eat sound played');
            }
            
            function playGameOverSound() {
                // In a real game, this would play an audio file
                console.log('Game over sound played');
            }
            
            // Event Listeners
            document.addEventListener('keydown', function(e) {
                // Handle direction changes
                switch(e.key) {
                    case 'ArrowUp':
                        if (direction !== 'DOWN' && running && !paused) {
                            direction = 'UP';
                        }
                        break;
                    case 'ArrowDown':
                        if (direction !== 'UP' && running && !paused) {
                            direction = 'DOWN';
                        }
                        break;
                    case 'ArrowLeft':
                        if (direction !== 'RIGHT' && running && !paused) {
                            direction = 'LEFT';
                        }
                        break;
                    case 'ArrowRight':
                        if (direction !== 'LEFT' && running && !paused) {
                            direction = 'RIGHT';
                        }
                        break;
                    case 'p':
                    case 'P':
                        // Toggle pause
                        if (running) {
                            paused = !paused;
                            pauseButton.textContent = paused ? 'Resume (P)' : 'Pause (P)';
                            draw(); // Update display with pause overlay
                        }
                        break;
                }
            });
            
            // Direction buttons (mobile)
            upBtn.addEventListener('click', () => {
                if (direction !== 'DOWN' && running && !paused) {
                    direction = 'UP';
                }
            });
            
            rightBtn.addEventListener('click', () => {
                if (direction !== 'LEFT' && running && !paused) {
                    direction = 'RIGHT';
                }
            });
            
            downBtn.addEventListener('click', () => {
                if (direction !== 'UP' && running && !paused) {
                    direction = 'DOWN';
                }
            });
            
            leftBtn.addEventListener('click', () => {
                if (direction !== 'RIGHT' && running && !paused) {
                    direction = 'LEFT';
                }
            });
            
            // Button event listeners
            startButton.addEventListener('click', startGame);
            playAgainButton.addEventListener('click', function() {
                gameOverScreen.style.display = 'none';
                init();
                startGame();
            });
            
            pauseButton.addEventListener('click', function() {
                if (running) {
                    paused = !paused;
                    pauseButton.textContent = paused ? 'Resume (P)' : 'Pause (P)';
                    draw(); // Update display with pause overlay
                }
            });
            
            // Color selection
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    colorOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    
                    // Update snake color
                    snakeColor = this.getAttribute('data-color');
                });
            });
            
            // Initialize the game
            init();
        });
    </script>
</body>
</html>